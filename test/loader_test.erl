-module(loader_test).
-import(data_loader,[parse_line/1,load_geometry/1,load_conectivity/1
                                    ,load_hessian/1,load_gradient/1,enumerate_atoms/1,load_geometry/1
                                    ,parse_geom_line/1,load_templates/1,load_system/1]).
-ifdef(TEST).
-include_lib("eunit/include/eunit.hrl").

parse_line_test() ->
    ?assertEqual({atom,"C",{cartesian,0.0,1.0,1.0}},parse_line("C     0.000000 1.00000000          01.000000      ")).

% load_geometry_test() ->
%     ?assertEqual([{atom,"C",{cartesian,0.0,0.0,1.089}}
%                     ,{atom,"H",{cartesian,1.02672,0.0,-0.362996}}
%                     ,{atom,"H",{cartesian,-0.51336,-0.889165,-0.363}}
%                     ,{atom,"H",{cartesian,-0.51336,0.889165,-0.363}}
%                     ,{atom,"H",{cartesian,1.0,-3.0,9.0}}]
%                 ,load_geometry("../data/METANO/metano_geom_cart.dat")).

load_conectivity_test() ->
  ?assertEqual([{bond,2,1},{bond,3,1},{bond,4,1},{bond,5,1}
                ,{angle,3,1,2},{angle,4,1,3},{angle,5,1,2},{angle,5,1,4}
                ,{dihedral,4,1,3,2},{dihedral,5,1,4,2}]
                ,load_conectivity("../data/METANO/metano_conex_int.dat")).

load_templates_test() ->
  ?assertEqual([[4,3,2,1],[5,4,2,1]]
                ,load_templates("../data/METANO/metano_groups.dat")).
% enumerate_atoms_test() ->
%     ?assertEqual([{atom,"C",1,{cartesian,0.0,0.0,1.089}}
%                 ,{atom,"H",2,{cartesian,1.02672,0.0,-0.362996}}
%                 ,{atom,"H",3,{cartesian,-0.51336,-0.889165,-0.363}}
%                 ,{atom,"H",4,{cartesian,-0.51336,0.889165,-0.363}}
%                 ,{atom,"H",5,{cartesian,1.0,-3.0,9.0}}]
%                 ,enumerate_atoms(load_geometry("../data/METANO/metano_geom_cart.dat"))).

parse_geom_line_test() ->
    ?assertEqual([2.05791176,1.94021962,0.0,-0.685963027,-0.970109808]
                    ,parse_geom_line("  2.05791176E+00  1.94021962E+00  0.00000000E+00 -6.85963027E-01 -9.70109808E-01")).
load_hessian_test() ->
    ?assertEqual(
                [4.755455e-01,-4.910828e-03,-4.910886e-03,-4.910886e-03,1.015961e-02,-5.447814e-03,6.184048e-03,-4.711611e-03,-8.896305e-03,-7.694076e-03,-4.910828e-03,4.755466e-01,-4.910923e-03,-4.910923e-03,4.122839e-03,4.122644e-03,-8.834165e-04,-8.245329e-03,6.732296e-03,1.202196e-02,-4.910886e-03,-4.910923e-03,4.755446e-01,-4.910862e-03,-6.331303e-03,9.276037e-03,-5.889578e-03,1.266255e-02,-1.033889e-02,-4.808785e-03,-4.910886e-03,-4.910923e-03,-4.910862e-03,4.755446e-01,-7.950871e-03,-7.950894e-03,5.889727e-04,2.945050e-04,1.250285e-02,4.808568e-04,1.015961e-02,4.122839e-03,-6.331303e-03,-7.950871e-03,3.070119e-01,1.178758e-01,8.787025e-02,1.118585e-01,-1.143705e-02,-5.174169e-02,-5.447814e-03,4.122644e-03,9.276037e-03,-7.950894e-03,1.178758e-01,3.073532e-01,9.020513e-02,1.084987e-01,-1.115830e-02,-5.230030e-02,6.184048e-03,-8.834165e-04,-5.889578e-03,5.889727e-04,8.787025e-02,9.020513e-02,1.002771e-01,-1.715659e-02,2.081775e-02,-4.737473e-02,-4.711611e-03,-8.245329e-03,1.266255e-02,2.945050e-04,1.118585e-01,1.084987e-01,-1.715659e-02,2.417343e-01,-3.816982e-02,-7.863367e-02,-8.896305e-03,6.732296e-03,-1.033889e-02,1.250285e-02,-1.143705e-02,-1.115830e-02,2.081775e-02,-3.816982e-02,1.535839e-01,6.775129e-02,-7.694076e-03,1.202196e-02,-4.808785e-03,4.808568e-04,-5.174169e-02,-5.230030e-02,-4.737473e-02,-7.863367e-02,6.775129e-02,1.081945e-01]
                ,load_hessian("../data/METANO/metano_hess_int.dat")).
load_hessian_length_test() ->
    ?assertEqual(
                100
                ,length(load_hessian("../data/METANO/metano_hess_int.dat"))).

load_gradient_test() ->
    ?assertEqual(
                [5.290983e-03,5.290661e-03,5.291442e-03,5.291442e-03,-9.966900e-07,1.400879e-07,-1.418337e-07,-3.267653e-07,2.287642e-07,2.259142e-07]
                ,load_gradient("../data/METANO/metano_grad_int.dat")).

% load_system_test() ->
%     ?assertEqual(
%                 {system,{[{atom,"C",1,{cartesian,0.0,0.0,1.089}}
%                         ,{atom,"H",2,{cartesian,1.02672,0.0,-0.362996}}
%                         ,{atom,"H",3,{cartesian,-0.51336,-0.889165,-0.363}}
%                         ,{atom,"H",4,{cartesian,-0.51336,0.889165,-0.363}}
%                         ,{atom,"H",5,{cartesian,1.0,-3.0,9.0}}]
%                         ,{conectivity,[{bond,2,1},{bond,3,1},{bond,4,1},{bond,5,1},{angle,3,1,2},{angle,4,1,3},{angle,5,1,2},{angle,5,1,4}
%                         ,{dihedral,4,1,3,2},{dihedral,5,1,4,2}]}
%                         ,{gradient,[5.290983e-03,5.290661e-03,5.291442e-03,5.291442e-03,-9.966900e-07,1.400879e-07,-1.418337e-07,-3.267653e-07,2.287642e-07,2.259142e-07]}
%                         ,{hessian,[4.755455e-01,-4.910828e-03,-4.910886e-03,-4.910886e-03,1.015961e-02,-5.447814e-03,6.184048e-03,-4.711611e-03,-8.896305e-03,-7.694076e-03,-4.910828e-03,4.755466e-01,-4.910923e-03,-4.910923e-03,4.122839e-03,4.122644e-03,-8.834165e-04,-8.245329e-03,6.732296e-03,1.202196e-02,-4.910886e-03,-4.910923e-03,4.755446e-01,-4.910862e-03,-6.331303e-03,9.276037e-03,-5.889578e-03,1.266255e-02,-1.033889e-02,-4.808785e-03,-4.910886e-03,-4.910923e-03,-4.910862e-03,4.755446e-01,-7.950871e-03,-7.950894e-03,5.889727e-04,2.945050e-04,1.250285e-02,4.808568e-04,1.015961e-02,4.122839e-03,-6.331303e-03,-7.950871e-03,3.070119e-01,1.178758e-01,8.787025e-02,1.118585e-01,-1.143705e-02,-5.174169e-02,-5.447814e-03,4.122644e-03,9.276037e-03,-7.950894e-03,1.178758e-01,3.073532e-01,9.020513e-02,1.084987e-01,-1.115830e-02,-5.230030e-02,6.184048e-03,-8.834165e-04,-5.889578e-03,5.889727e-04,8.787025e-02,9.020513e-02,1.002771e-01,-1.715659e-02,2.081775e-02,-4.737473e-02,-4.711611e-03,-8.245329e-03,1.266255e-02,2.945050e-04,1.118585e-01,1.084987e-01,-1.715659e-02,2.417343e-01,-3.816982e-02,-7.863367e-02,-8.896305e-03,6.732296e-03,-1.033889e-02,1.250285e-02,-1.143705e-02,-1.115830e-02,2.081775e-02,-3.816982e-02,1.535839e-01,6.775129e-02,-7.694076e-03,1.202196e-02,-4.808785e-03,4.808568e-04,-5.174169e-02,-5.230030e-02,-4.737473e-02,-7.863367e-02,6.775129e-02,1.081945e-01]}
%                         ,{templates,[[4,3,2,1],[5,4,2,1]]}
%                         }}
%                     ,load_system("../data/METANO/metano")).

-endif. 